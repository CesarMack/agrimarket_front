<section class="p-10 relative w-full h-screen bg-[#f6f6f6]">
  <div
    *ngIf="showSuccessMessage"
    id="alert-3"
    class="flex absolute top-0 left-10 right-10 items-center p-4 mb-4 text-green-800 rounded-lg bg-green-400"
    role="alert"
  >
    <svg
      class="flex-shrink-0 w-4 h-4"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="currentColor"
      viewBox="0 0 20 20"
    >
      <path
        d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"
      />
    </svg>
    <span class="sr-only">Info</span>
    <div class="ml-3 text-sm font-medium">Operacion Exitosa</div>
    <button
      type="button"
      class="ml-auto -mx-1.5 -my-1.5 bg-green-50 text-green-500 rounded-lg focus:ring-2 focus:ring-green-400 p-1.5 hover:bg-green-200 inline-flex items-center justify-center h-8 w-8"
      data-dismiss-target="#alert-3"
      aria-label="Close"
    >
      <span class="sr-only">Close</span>
      <svg
        class="w-3 h-3"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 14 14"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
        />
      </svg>
    </button>
  </div>
  <div
    *ngIf="loader"
    class="fixed top-0 left-0 w-full h-full bg-white bg-opacity-80 flex justify-center items-center z-50"
  >
    <div
      class="animate-spin rounded-full border-t-4 border-blue-500 border-opacity-75 h-12 w-12"
    ></div>
    <span class="ml-2">Cargando...</span>
  </div>
  <div class="p-10 bg-white shadow-lg rounded-3xl w-full h-full flex flex-col">
    <h3
      class="text-3xl font-bold text-[#2A9763] font-['Montserrat_Alternates']"
    >
      Productos
    </h3>
    <div class="flex w-full gap-10">
      <div class="w-1/3">
        <div class="flex border-b border-[#2A9763] my-5">
          <h3
            class="text-lg font-bold text-[#2A9763] font-['Montserrat_Alternates']"
          >
            Agregar Producto:
          </h3>
        </div>

        <article class="h-1/3 bg-[#f6f6f6] p-5 rounded-3xl shadow">
          <form [formGroup]="productForm" (ngSubmit)="determineAction()">
            <!-- Campo oculto para almacenar el ID del producto -->
            <input type="hidden" formControlName="productId" />

            <span class="flex flex-col">
              <label>Nombre:</label>
              <input
                formControlName="name"
                type="text"
                class="h-10 px-4 py-3 border border-gray-400 rounded-3xl"
              />
            </span>
            <span class="mt-5 flex flex-col">
              <label>Categoria:</label>
              <select
                class="h-10 px-4 border border-gray-400 rounded-3xl"
                formControlName="categories"
              >
                <option
                  *ngFor="let item of categoriesData?.data"
                  [value]="item.name"
                  [attr.data-id-category]="item.id"
                >
                  {{ item.name }}
                </option>
              </select>
            </span>
            <span class="flex gap-5 mt-5">
              <input
                type="submit"
                class="cursor-pointer h-11 w-1/2 bg-[#2A9763] text-white rounded-3xl font-semibold text-lg shadow-lg"
                value=" Aceptar"
              />
              <input
                type="reset"
                class="cursor-pointer h-11 w-1/2 bg-red-700 text-white rounded-3xl font-semibold text-lg shadow-lg"
                value="Cancelar"
              />
            </span>
          </form>
        </article>

        <div class="flex border-b border-[#2A9763] my-5">
          <h3
            class="text-lg font-bold text-[#2A9763] font-['Montserrat_Alternates']"
          >
            Sugerencia Prefijos:
          </h3>
        </div>
        <article
          class="p-5 h-[350px] rounded-2xl shadow bg-[#f6f6f6] overflow-y-auto"
        >
          <div class="flow-root overflow-y-auto">
            <ul
              role="list"
              class="divide-y divide-gray-200 dark:divide-gray-700"
            >
              <ng-container
                *ngIf="(suggestionsData?.data)!.length > 0; else noSuggestions"
              >
                <li
                  class="py-3 sm:py-4"
                  *ngFor="let suggestion of suggestionsData?.data"
                >
                  <div class="flex items-center space-x-4">
                    <div class="flex-1 min-w-0">
                      <p class="text-sm font-medium text-gray-900 truncate">
                        {{ suggestion.suggestion }}
                        <!-- Nombre del Producto -->
                      </p>
                      <p
                        class="text-sm text-gray-500 truncate dark:text-gray-400"
                      >
                        {{ suggestion.created_at }}
                        <!-- Fecha de creaciÃ³n -->
                      </p>
                      <!-- Otros campos que desees mostrar -->
                    </div>
                  </div>
                </li>
              </ng-container>
            </ul>
            <ng-template #noSuggestions>
              <div class="py-4 text-center text-gray-500 dark:text-gray-400">
                No hay sugerencias por el momento.
              </div>
            </ng-template>
          </div>
        </article>
      </div>

      <div class="w-full">
        <div class="flex border-b border-[#2A9763] my-5">
          <h3
            class="text-lg font-bold text-[#2A9763] font-['Montserrat_Alternates']"
          >
            Productos:
          </h3>
        </div>

        <div class="rounded-3xl h-[665px] bg-[#f6f6f6] shadow">
          <form
            [formGroup]="searchForm"
            (ngSubmit)="searchProductType()"
            class="p-5 flex gap-4 w-3/6"
          >
            <div class="relative w-full border-3xl">
              <input
                formControlName="search"
                placeholder="Search"
                class="p-4 py-3 outline-none focus pr-10 bg-white border rounded-3xl border-gray-400 text-slate-600 h-full w-full leading-4"
              />
              <svg
                class="absolute pointer-events-none top-3 right-5"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17Z"
                  stroke="#4B5563"
                  stroke-width="1.66667"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M21 21L15 15"
                  stroke="#4B5563"
                  stroke-width="1.66667"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </div>
            <button
              class="text-white lg:max-w-[164px] px-6 py-4 w-full rounded-3xl leading-[14px] bg-[#2A9763] shadow-lg font-medium"
            >
              Search
            </button>
          </form>

          <div
            class="h-[550px] overflow-y-auto bg-[#f6f6f6] row-start-1 row-end-3"
          >
            <table
              [cellPadding]="0"
              [cellSpacing]="0"
              class="w-full text-center"
            >
              <thead class="sticky top-0 bg-gray-100">
                <tr
                  tabindex="0"
                  class="focus:outline-none h-16 w-full text-sm leading-none text-gray-800"
                >
                  <th class="font-normal">Nombre</th>
                  <th class="font-normal">Categoria</th>
                  <th class="font-normal">Estado</th>
                  <th class="font-normal">Fecha de Creacion</th>
                  <th class="font-normal">Fecha de Actualizacion</th>
                  <th class="font-normal text-left pl-20"></th>
                </tr>
              </thead>
              <tbody class="w-full">
                <tr
                  class="focus:outline-none h-20 text-sm leading-none text-gray-800 bg-[#f6f6f6] hover:bg-gray-100 border-b border-t"
                  *ngFor="let data of productsData?.data"
                  [attr.data-id]="data?.id"
                >
                  <td>
                    <p class="font-medium">{{ data?.name }}</p>
                  </td>
                  <td>
                    <p class="font-medium">{{ data?.category }}</p>
                  </td>
                  <td>
                    <p class="font-medium">
                      <ng-container
                        *ngIf="data?.active === 1; else inactiveText"
                        ><span
                          class="bg-green-100 text-green-800 font-medium px-4 py-2 rounded-full"
                          >Activo</span
                        >
                      </ng-container>
                      <ng-template #inactiveText>
                        <span
                          class="bg-yellow-100 text-yellow-800 font-medium px-4 py-2 rounded-full"
                          >Inactivo</span
                        >
                      </ng-template>
                    </p>
                  </td>
                  <td>
                    <p class="font-medium">
                      {{ data?.created_at | date : "dd-MM-yyyy" }}
                    </p>
                  </td>
                  <td>
                    <p class="font-medium">
                      {{ data?.updated_at | date : "dd-MM-yyyy" }}
                    </p>
                  </td>
                  <td>
                    <div class="flex items-center">
                      <button
                        [disabled]="data?.active !== 1"
                        (click)="showProductDetails(data)"
                        class="focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 bg-gray-100 dark:bg-gray-800 mr-5 hover:bg-gray-200 dark:hover:bg-gray-700 py-2.5 px-5 rounded text-sm leading-3 text-gray-600 dark:text-gray-200 focus:outline-none
         {{ data?.active !== 1 ? 'cursor-not-allowed opacity-50' : '' }}"
                      >
                        Mostrar
                      </button>
                      <button
                        (click)="changeStatus(data?.id!)"
                        class="focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 bg-gray-100 dark:bg-gray-800 mr-5 hover:bg-gray-200 dark:hover:bg-gray-700 py-2.5 px-5 rounded text-sm leading-3 text-gray-600 dark:text-gray-200 focus:outline-none"
                      >
                        Activar
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
